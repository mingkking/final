<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.dao.CountDAO">

   <!-- session 생성 시 데이터 저장(방문자 데이터) -->
   <insert id="saveSession" parameterType="CountVO">
         INSERT INTO countVisit(sessionId, creationTime)
       VALUES(#{sessionId}, TRUNC(SYSDATE))
   </insert>
   
   <!-- 총 방문자 수 -->
   <select id="selectTotalSession" parameterType="CountVO" resultType="int">
      SELECT count(*)
      FROM countVisit
   </select>
   
   <!-- 오늘 방문자 수 -->
   <select id="selectTodaySession" parameterType="CountVO" resultType="int">
      SELECT count(*)
      FROM countVisit
      WHERE TRUNC(creationTime) = TRUNC(SYSDATE)
   </select>
   
   <!-- 한 달 방문자 수 -->
   <select id="selectMonthSession" parameterType="CountVO" resultType="int">
      SELECT count(*)
      FROM countVisit
      WHERE creationTime BETWEEN TRUNC(SYSDATE) - INTERVAL '1' MONTH AND TRUNC(SYSDATE)
   </select>
   
   <!-- 회원 수 -->
   <select id="selectTotalMembers" parameterType="MemberCountVO" resultType="int">
      SELECT count(*)
      FROM users
   </select>
   
   <!-- 금일 회원가입 수 -->
   <!--  
   <select id="selectTodayMembers" parameterType="MemberCountVO" resultType="int">
      SELECT count(*)
      FROM users
      WHERE TRUNC(creationTime) = TRUNC(SYSDATE)
   </select>
    -->
    
    <!-- 구독자 수 -->
    <select id="selectTotalSubscribers" parameterType="SubscriberCountVO" resultType="int">
    	SELECT count(*)
    	FROM subscribe
    </select>
   
</mapper>

